# 最简单的CNN实现

这个项目展示了三种不同复杂度的CNN（卷积神经网络）实现，从完整训练版本到最精简版本。

## 文件说明

### 1. `main.py` - 完整训练版本
- 完整的CNN模型训练流程
- 使用MNIST手写数字数据集
- 包含训练、测试、可视化功能
- 可以保存和加载模型

### 2. `simplest_cnn.py` - 教学版本
- 详细的CNN概念解释
- 逐步演示前向传播过程
- 包含参数统计和模型分析
- 适合初学者学习CNN原理

### 3. `minimal_cnn.py` - 最精简版本
- 仅包含核心CNN代码
- 最少的代码行数实现CNN
- 适合快速理解CNN基本结构

## CNN基本结构

最简单的CNN包含以下层：

1. **卷积层 (Convolutional Layer)**
   - 提取图像局部特征
   - 使用卷积核在图像上滑动计算

2. **激活函数 (Activation Function)**
   - 引入非线性
   - 常用ReLU: f(x) = max(0, x)

3. **池化层 (Pooling Layer)**
   - 下采样，减少计算量
   - 常用最大池化：取窗口内最大值

4. **全连接层 (Fully Connected Layer)**
   - 将提取的特征进行分类
   - 输出每个类别的得分

## 运行方法

### 运行完整训练版本：
```bash
python main.py
```

### 运行教学版本：
```bash
python simplest_cnn.py
```

### 运行最精简版本：
```bash
python minimal_cnn.py
```

## 依赖库

- PyTorch
- torchvision
- matplotlib
- numpy

安装命令：
```bash
pip install torch torchvision matplotlib numpy
```

## 模型参数

最简单的CNN模型参数：
- 输入：28×28灰度图像（1通道）
- 卷积层：16个3×3卷积核
- 池化层：2×2最大池化
- 全连接层：10个输出（对应0-9数字）
- 总参数：约31,754个

## 学习要点

1. **卷积操作**：使用小窗口（卷积核）在图像上滑动，提取局部特征
2. **特征图**：每个卷积核产生一个特征图，表示某种特征的存在
3. **池化**：降低特征图尺寸，增强特征不变性
4. **展平**：将多维特征图转换为一维向量，输入全连接层
5. **分类**：全连接层输出每个类别的得分

## 扩展建议

1. 增加卷积层数量
2. 尝试不同的卷积核大小
3. 使用不同的激活函数
4. 添加Dropout防止过拟合
5. 使用批归一化加速训练

## 适用场景

这个简单的CNN适用于：
- 手写数字识别（MNIST）
- 简单的图像分类任务
- CNN入门学习
- 原型验证和快速实验